# YOLO Label Verification Configuration

# 모델 설정
model:
  cache_dir: "./models"  # 모델 다운로드 위치
  selected_model: null   # 선택된 모델 (자동 설정됨)
  
# 데이터 경로
paths:
  input_images: "F:/solbrain/data_1210/JPEGImages"
  input_labels: "F:/solbrain/data_1210/labels"
  output_base: "F:/solbrain/data_1210/output"
  
# 클래스 매핑 (YOLO class_id: class_name)
classes:
  0: ["person", "people", "human","pedestrian"]
  1: ["slip", "fall", "slipping", "falling"]
  2: ["head", "face"]
  3: ["safety helmet", "hard hat", "helmet", "construction helmet"]
  6: ["car", "automobile", "vehicle"]
  7: ["bus", "coach"]
  8: ["truck", "lorry", "cargo truck"]
  9: ["forklift", "lift truck"]
  11: ["chair", "seat"]
  13: ["bird"]
  14: ["animal", "cat", "dog", "pet"]
  99: ["unknown"]  # fallback - 첫 번째 이름이 대표 이름용
  
# 검증 설정
verification:
  mode: "single"  # "single" 또는 "batch"
  batch_size: 8   # batch 모드일 때 한 번에 처리할 박스 수
  crop_method: "crop"  # "crop" 또는 "full_image"
  
  # Confidence 설정
  confidence_threshold: 0.6  # 신뢰도 임계값
  create_uncertain_folder: true  # 애매한 경우 별도 폴더 생성
  
  # 이미지 크롭 설정
  crop_padding: 10  # 박스 주변 패딩 (픽셀)
  crop_min_size: 50  # 최소 크롭 크기 (픽셀)
  max_image_size: 1280  # 모델 입력 최대 크기
  
# 자동 라벨 수정 설정
auto_correction:
  enabled: true                    # 자동 수정 기능 활성화2
  ask_alternative: true            # mislabeled시 "그럼 뭐야?" 질문
  fallback_class: "unknown"        # 매칭 안되면 이 클래스로
  save_original: true              # 원본 라벨 백업 (labels_original 폴더)
  similarity_threshold: 0.6        # 클래스명 유사도 임계값 (0.0-1.0)

# 장면 분류 설정
scene_classification:
  enabled: false                    # 장면 분류 활성화
  classify_per_image: false         # 이미지마다 분류

# 디버그 시각화 설정
debug:
  save_visualization: true         # 검증 결과 시각화 이미지 저장
  show_confidence: true            # confidence 값 표시
  show_response: true              # VLM 응답 텍스트 표시

# 처리 옵션
processing:
  show_progress: true  # 진행률 표시
  save_visualizations: false  # 검증 결과 시각화 저장
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  
  # GPU 설정
  device: "auto"  # "auto", "cuda", "cpu"
  empty_cache_frequency: 100  # N개 이미지마다 캐시 비우기
  
  # 재시도 설정
  max_retries: 3  # 모델 응답 실패시 재시도 횟수
  retry_delay: 1.0  # 재시도 간 대기 시간 (초)

# 결과 설정
output:
  copy_files: true  # 파일 복사 (false면 symlink)
  generate_report: true  # JSON 리포트 생성
  save_failed_queries: true  # 실패한 쿼리 저장
  
# 프롬프트 최적화 설정
prompt_optimization:
  enabled: false  # 프롬프트 최적화 사용 여부

  # Ground Truth 데이터
  ground_truth:
    path: "prompt_discovery/test_db"  # GT 이미지/라벨 경로
    min_samples_per_class: 10  # 클래스당 최소 샘플 수

  # 프롬프트 생성 설정
  generation:
    use_builtin_templates: true  # 내장 템플릿 사용
    custom_prompts: []  # 사용자 정의 프롬프트 추가

  # 테스트 설정
  testing:
    max_candidates: 30  # 테스트할 최대 프롬프트 수
    save_top_n: 10  # 상위 N개 결과 저장

  # 템플릿 설정
  templates:
    dir: "prompt_discovery/templates"
    current: "current.yaml"
    auto_save_best: true  # 최고 성능 프롬프트 자동 저장

  # 프로덕션 설정
  production:
    use_optimized_prompts: false  # 최적화된 프롬프트 사용
    fallback_prompt: "Is this object a {class_name}? Answer Yes or No."

# 사용 가능한 Qwen3-VL 모델 목록
available_models:
  - name: "Qwen3-VL-2B-Instruct"
    id: "Qwen/Qwen3-VL-2B-Instruct"
    size: "2B"
    vram: "~4GB"
    description: "가장 빠른 모델, 기본 검증용"
    
  - name: "Qwen3-VL-4B-Instruct"
    id: "Qwen/Qwen3-VL-4B-Instruct"
    size: "4B"
    vram: "~8GB"
    description: "빠르고 효율적, 대량 데이터 처리"
    
  - name: "Qwen3-VL-8B-Instruct"
    id: "Qwen/Qwen3-VL-8B-Instruct"
    size: "8B"
    vram: "~16GB"
    description: "권장 모델, 성능/속도 균형"
    
  - name: "Qwen3-VL-32B-Instruct"
    id: "Qwen/Qwen3-VL-32B-Instruct"
    size: "32B"
    vram: "~64GB"
    description: "고성능 모델, 최고 정확도"
    
  - name: "Qwen3-VL-30B-A3B-Instruct"
    id: "Qwen/Qwen3-VL-30B-A3B-Instruct"
    size: "30B (3B active)"
    vram: "~60GB"
    description: "MoE 모델, 높은 정확도"